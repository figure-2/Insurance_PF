# 리트리버 문맥 품질 검증 결과 분석

**작성 일시:** 2025-11-22 03:30 (KST)

## 1. 검증 목적

LLM에게 전달될 검색 결과(Context)가 실제로 질문에 답변하기에 충분한 정보를 담고 있는지 육안으로 확인.

## 2. 테스트 쿼리 (5개)

1. **음주운전하면 보상 받을 수 있나요?** (면책/보상 질문)
2. **자기부담금은 얼마인가요?** (수치/조건 질문)
3. **사고 났을 때 보험금 청구는 어떻게 하나요?** (절차/방법 질문)
4. **무보험자동차란 무엇인가요?** (정의/용어 질문)
5. **다른 사람 차를 운전하다가 사고가 나면 제 보험으로 처리 되나요?** (복합 상황 질문)

## 3. 검증 결과

### 3.1 성공 케이스 (✅)

#### 질문 1: 음주운전하면 보상 받을 수 있나요?
- **Rank 3**에서 정확한 답변 발견
- **출처:** 삼성화재해상보험주식회사
- **내용:** "무면허운전이나 음주운전 사고 시 제한적으로 보상이 가능하며..." + 상세한 면책/보상 테이블 포함
- **평가:** ✅ **Pass** - LLM이 답변하기에 충분한 정보

#### 질문 2: 자기부담금은 얼마인가요?
- **Rank 1**에서 정확한 답변 발견
- **출처:** 삼성화재해상보험주식회사
- **내용:** "자기부담금이란 보험증권에 기재된 최소자기부담금과 최대자기부담금을 한도로..."
- **평가:** ✅ **Pass** - 정의와 계산 방법이 명확히 설명됨

#### 질문 3: 사고 났을 때 보험금 청구는 어떻게 하나요?
- **Rank 2**에서 절차 정보 발견
- **출처:** 현대해상화재보험주식회사
- **내용:** 사고 접수 → 보상 담당자 배정 → 사고조사 → 보험금 결정 → 지급의 전체 프로세스 설명
- **평가:** ✅ **Pass** - 절차가 단계별로 명확히 설명됨

### 3.2 실패 케이스 (❌)

#### 질문 4: 무보험자동차란 무엇인가요?
- **Rank 1-3 모두 관련 없는 내용**
  - Rank 1: "동일증권이란 무엇인가요?"
  - Rank 2: "상해급수란 무엇인가요?"
  - Rank 3: "의무보험이란 무엇인가요?"
- **평가:** ❌ **Fail** - 검색 실패
- **원인 분석:**
  - "무보험자동차"라는 용어가 실제 약관에서는 다른 표현으로 사용될 수 있음 (예: "무보험차", "보험 미가입 차량")
  - BM25는 정확한 키워드 매칭에 의존하므로, 동의어/유사어 처리에 한계

#### 질문 5: 다른 사람 차를 운전하다가 사고가 나면 제 보험으로 처리 되나요?
- **Rank 1-3 모두 "의무보험" 관련 내용만 검색**
- **평가:** ⚠️ **Warning** - 부분적으로 관련은 있으나 직접적인 답변 부족
- **원인 분석:**
  - 질문이 복합적임 ("다른 사람 차" + "제 보험" + "처리")
  - BM25가 단순 키워드 매칭만 하므로, 의미적 연관성을 파악하지 못함

## 4. 종합 분석

### 4.1 강점 (Strengths)

1. **명확한 키워드 질문에 강함:**
   - "음주운전", "자기부담금" 같은 정확한 용어가 포함된 질문에서 우수한 성능
   - 보험 약관의 전문 용어를 정확히 매칭

2. **FAQ 형식 문서 검색 우수:**
   - "Q. ..." 형식의 질문-답변 구조 문서를 잘 찾아냄

### 4.2 약점 (Weaknesses)

1. **동의어/유사어 처리 한계:**
   - "무보험자동차" vs "무보험차" 같은 표현 차이에 취약
   - **해결 방안:** 사용자 질문 전처리(동의어 확장) 또는 Dense 검색과의 하이브리드 활용

2. **복합 질문 처리 약함:**
   - 여러 개념이 결합된 질문(질문 5)에서 핵심 답변을 놓침
   - **해결 방안:** 질문 분해(Query Decomposition) 또는 리랭커 도입

3. **의미적 연관성 파악 부족:**
   - 단순 키워드 매칭에 의존하여, 문맥적 의미를 고려하지 못함
   - **해결 방안:** Dense 검색과의 하이브리드 또는 리랭커 도입

## 5. 결론 및 개선 방안

### 5.1 현재 상태 평가

- **성공률:** 3/5 (60%)
- **평가:** 기본적인 키워드 기반 검색은 잘 작동하나, 동의어 처리와 복합 질문에 한계

### 5.2 개선 방안

1. **단기 (즉시 적용 가능):**
   - 사용자 질문 전처리: 동의어 사전 구축 및 질문 확장
   - Top-K 증가: 현재 Top-3 → Top-5로 확대하여 리랭커에 더 많은 후보 제공

2. **중기 (리랭커 도입):**
   - **Cross-Encoder 리랭커** 도입: 질문-문서 쌍의 관련성을 정밀하게 재평가
   - 하이브리드 리트리버 재검토: Dense 검색을 보조로 활용하여 의미적 연관성 보완

3. **장기 (청킹 전략 개선):**
   - 청킹 전략 재검토: 현재 청킹이 너무 짧아서 문맥이 끊겼는지 확인 필요

---

**Next Step:** 리랭커 도입 전, 동의어 확장 및 Top-K 증가로 즉시 개선 가능한 부분부터 적용.

